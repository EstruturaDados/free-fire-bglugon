#include <stdio.h>
#include <stdlib.h>  
#include <string.h> 

// Definição da estrutura que representa um ITEM da mochila
typedef struct {
    char nome[30];     // Nome do item (ex: "Rifle", "Bandagem", "Kit Médico")
    char tipo[20];     // Tipo do item (ex: "arma", "munição", "cura")
    int quantidade;    // Quantidade de unidades do item
} Item;

// Protótipos das funções utilizadas no programa
void inserirItem(Item mochila[], int *tamanho);   // Cadastra novo item
void removerItem(Item mochila[], int *tamanho);   // Remove item existente
void listarItens(Item mochila[], int tamanho);    // Lista todos os itens
void buscarItem(Item mochila[], int tamanho);     // Busca item pelo nome

// Função principal — controla o menu do sistema
int main() {
    Item mochila[10];  // Vetor de até 10 itens representando a mochila do jogador
    int tamanho = 0;   // Contador de itens cadastrados
    int opcao;         // Opção do menu escolhida pelo jogador

    do {
        // Menu de opções do sistema
        printf("\n--------- INVENTÁRIO DO JOGADOR ---------\n");
        printf("1 - Adicionar item\n");
        printf("2 - Remover item\n");
        printf("3 - Listar itens\n");
        printf("4 - Buscar item\n");
        printf("0 - Sair\n");
        printf("Escolha uma opção: ");
        scanf("%d", &opcao);
        getchar(); // Limpa o buffer de entrada após o scanf()

        // Controle de fluxo com base na opção escolhida
        switch (opcao) {
            case 1:
                inserirItem(mochila, &tamanho);
                break;
            case 2:
                removerItem(mochila, &tamanho);
                break;
            case 3:
                listarItens(mochila, tamanho);
                break;
            case 4:
                buscarItem(mochila, tamanho);
                break;
            case 0:
                printf("\nSaindo do sistema...\n");
                break;
            default:
                printf("Opção inválida! Tente novamente.\n");
        }
    } while (opcao != 0); // Repete até o jogador escolher "Sair"

    return 0;
}

// Função: inserirItem()  -  Objetivo: Cadastrar um novo item na mochila
void inserirItem(Item mochila[], int *tamanho) {
    // Verifica se a mochila está cheia
    if (*tamanho >= 10) {
        printf("\nA mochila está cheia! Não é possível adicionar mais itens.\n");
        return;
    }

    printf("\n--- Cadastro de Novo Item ---\n");

    // Lê o nome do item
    printf("Nome do item: ");
    fgets(mochila[*tamanho].nome, 30, stdin);
    mochila[*tamanho].nome[strcspn(mochila[*tamanho].nome, "\n")] = '\0'; // Remove o '\n'

    // Lê o tipo do item
    printf("Tipo do item (arma, munição, cura, etc): ");
    fgets(mochila[*tamanho].tipo, 20, stdin);
    mochila[*tamanho].tipo[strcspn(mochila[*tamanho].tipo, "\n")] = '\0'; // Remove o '\n'

    // Lê a quantidade do item
    printf("Quantidade: ");
    scanf("%d", &mochila[*tamanho].quantidade);
    getchar(); // Limpa o buffer de entrada

    // Incrementa o número total de itens cadastrados
    (*tamanho)++;

    printf("\nItem adicionado com sucesso!\n");

    // Exibe os itens atualizados
    listarItens(mochila, *tamanho);
}

// Função: removerItem()  -  Objetivo: Remover um item da mochila com base no nome
void removerItem(Item mochila[], int *tamanho) {
    // Verifica se há itens cadastrados
    if (*tamanho == 0) {
        printf("\nA mochila está vazia!\n");
        return;
    }

    char nome[30];
    printf("\nDigite o nome do item a ser removido: ");
    fgets(nome, 30, stdin);
    nome[strcspn(nome, "\n")] = '\0'; // Remove o '\n'

    int encontrado = -1; // Índice do item encontrado (ou -1 se não encontrar)

    // Busca sequencial pelo nome do item
    for (int i = 0; i < *tamanho; i++) {
        if (strcmp(mochila[i].nome, nome) == 0) {
            encontrado = i;
            break;
        }
    }

    // Se o item não foi encontrado
    if (encontrado == -1) {
        printf("\nItem não encontrado na mochila.\n");
        return;
    }

    // Desloca os itens para preencher o espaço do item removido
    for (int i = encontrado; i < *tamanho - 1; i++) {
        mochila[i] = mochila[i + 1];
    }

    // Diminui o contador de itens
    (*tamanho)--;

    printf("\nItem removido com sucesso!\n");

    // Exibe a lista atualizada de itens
    listarItens(mochila, *tamanho);
}

// Função: listarItens()  -  Objetivo: Exibir todos os itens da mochila
void listarItens(Item mochila[], int tamanho) {
    printf("\n--- Itens na Mochila ---\n");

    // Caso não existam itens cadastrados
    if (tamanho == 0) {
        printf("Nenhum item cadastrado.\n");
        return;
    }

    // Exibe os itens com seus dados
    for (int i = 0; i < tamanho; i++) {
        printf("%d) Nome: %s | Tipo: %s | Quantidade: %d\n",
               i + 1, mochila[i].nome, mochila[i].tipo, mochila[i].quantidade);
    }
}

// Função: buscarItem()  -  Objetivo: Localizar e exibir dados de um item pelo nome
void buscarItem(Item mochila[], int tamanho) {
    // Verifica se há itens na mochila
    if (tamanho == 0) {
        printf("\nA mochila está vazia!\n");
        return;
    }

    char nome[30];
    printf("\nDigite o nome do item que deseja buscar: ");
    fgets(nome, 30, stdin);
    nome[strcspn(nome, "\n")] = '\0'; // Remove o '\n'

    // Busca sequencial — percorre o vetor de itens
    for (int i = 0; i < tamanho; i++) {
        if (strcmp(mochila[i].nome, nome) == 0) {
            printf("\nItem encontrado!\n");
            printf("Nome: %s | Tipo: %s | Quantidade: %d\n",
                   mochila[i].nome, mochila[i].tipo, mochila[i].quantidade);
            return;
        }
    }

    // Caso o item não seja encontrado
    printf("\nItem não encontrado na mochila.\n");
}
